# Story 1.1: Implement Core Language Infrastructure and Content Foundation

## Status
Draft

## Story
**As a** developer,  
**I want** to establish React Context API for language state management and create comprehensive JSON content structure,  
**so that** bilingual functionality has a solid technical foundation supporting all existing components without breaking current functionality.

## Acceptance Criteria

1. **Language Context Provider** is created and wraps the main App Router layout component, providing language state and toggle function to all child components
2. **Content JSON structure** is established in `/content/content.json` with nested Japanese/English objects for all existing page content (Hero, About, Age Groups, Navigation)
3. **Content loading utilities** are implemented in `/src/utils/contentLoader.ts` with TypeScript interfaces defining bilingual content structure
4. **Default language state** is set to Japanese maintaining current user experience for existing visitors
5. **Error boundaries** are implemented to handle JSON loading failures with graceful fallback to hardcoded Japanese content
6. **Build process integration** validates JSON content structure and completeness during Next.js build phase

## Tasks / Subtasks

- [ ] **Task 1: Create Language Context Infrastructure** (AC: 1, 4)
  - [ ] Create `/src/context/LanguageContext.tsx` with React Context API following state management template
  - [ ] Implement state interface with language ('ja' | 'en') and toggle function
  - [ ] Set default language state to 'ja' (Japanese)
  - [ ] Add custom hook `useLanguage()` for consuming context
  - [ ] Integrate context provider in `/src/app/layout.tsx` to wrap all child components

- [ ] **Task 2: Design and Implement Content JSON Structure** (AC: 2, 3)
  - [ ] Create `/content/content.json` with nested Japanese/English structure
  - [ ] Define content structure for Hero, About, Age Groups, Navigation components
  - [ ] Create TypeScript interfaces in `/src/types/content.ts` for bilingual content structure
  - [ ] Implement content loading utilities in `/src/utils/contentLoader.ts`
  - [ ] Add JSON validation schema for content structure

- [ ] **Task 3: Implement Error Handling and Fallbacks** (AC: 5)
  - [ ] Create error boundary component for JSON loading failures
  - [ ] Implement graceful fallback to hardcoded Japanese content
  - [ ] Add error logging for content loading issues
  - [ ] Test error scenarios and fallback behavior

- [ ] **Task 4: Build Process Integration** (AC: 6)
  - [ ] Add JSON content validation to Next.js build process
  - [ ] Create build-time content completeness checks
  - [ ] Add TypeScript compilation validation for content interfaces
  - [ ] Test build process with valid and invalid content structures

- [ ] **Task 5: Testing Implementation**
  - [ ] Write unit tests for LanguageContext provider and useLanguage hook
  - [ ] Create integration tests for content loading utilities
  - [ ] Test error boundary functionality with mock failures
  - [ ] Add build process validation tests

## Dev Notes

### Previous Story Insights
**No previous stories exist** - This is the foundation story for bilingual functionality.

### State Management Architecture
[Source: architecture/state-management.md]
- Use React Context API with useReducer pattern for language state management
- Follow established template with AppState interface, AppAction types, and reducer function
- Language state should include 'en' | 'ja' type with toggle functionality
- Context provider must wrap all components via layout.tsx integration
- Custom hook pattern: `useLanguage()` for consuming context with error handling

### Project Structure Guidelines
[Source: architecture/project-structure.md]
- Context files location: `/src/context/LanguageContext.tsx`
- Utility functions location: `/src/utils/contentLoader.ts`
- Type definitions location: `/src/types/content.ts`
- Content JSON location: `/content/content.json` (new directory at project root)
- Error boundaries location: `/src/components/ui/ErrorBoundary.tsx`

### Component Standards
[Source: architecture/component-standards.md]
- Use TypeScript interfaces for all component props
- Follow PascalCase naming: `LanguageContext.tsx`, `ErrorBoundary.tsx`
- Use camelCase for utilities: `contentLoader.ts`
- Implement proper error handling with try-catch blocks
- Include className prop support for styling flexibility

### Frontend Tech Stack Constraints
[Source: architecture/frontend-tech-stack.md]
- React Context API is the designated state management solution
- Next.js App Router structure must be maintained
- No external state management libraries (Redux, Zustand) allowed
- TypeScript interfaces required for type safety
- Build-time validation fits Next.js build pipeline

### Testing Requirements
[Source: architecture/testing-requirements.md]
- Jest + React Testing Library for unit tests
- Mock Framer Motion in tests to avoid animation issues
- Test file location: `__tests__/context/LanguageContext.test.tsx`
- Coverage target: 80% for new code
- Test structure: Arrange-Act-Assert pattern
- Mock external dependencies and JSON loading

### Content Structure Requirements
**No specific content structure guidance found in architecture docs** - Content JSON structure should be designed to support:
- Hero section: title, subtitle, button text
- Navigation: menu items, dropdown labels
- Age Groups: program names, descriptions
- About: section content, facility information
- Footer: contact details, social links

### Build Integration Requirements
**No specific build validation guidance found in architecture docs** - Build process integration should:
- Validate JSON schema at build time
- Check content completeness for both languages
- Fail build if content structure is invalid
- Provide clear error messages for content issues

## Testing

### Testing Standards
[Source: architecture/testing-requirements.md]
- **Test file location**: `__tests__/context/LanguageContext.test.tsx`, `__tests__/utils/contentLoader.test.tsx`
- **Testing framework**: Jest + React Testing Library
- **Mock requirements**: Framer Motion animations, JSON loading, file system operations
- **Coverage target**: 80% code coverage for new functionality
- **Test patterns**: Arrange-Act-Assert structure with proper setup/teardown

### Specific Testing Requirements for This Story
- Language context provider state management testing
- Content loading utility error handling validation
- Error boundary component failure scenario testing
- Build process validation testing with mock content structures
- Integration testing for context provider with consuming components

## Change Log

| Date | Version | Description | Author |
|------|---------|-------------|--------|
| 2025-01-13 | 1.0 | Initial story creation | Claude/Bob (Scrum Master) |

## Dev Agent Record

*This section will be populated by the development agent during implementation*

### Agent Model Used
*To be filled by dev agent*

### Debug Log References
*To be filled by dev agent*

### Completion Notes List
*To be filled by dev agent*

### File List
*To be filled by dev agent*

## QA Results

*Results from QA Agent review will be added here after implementation*